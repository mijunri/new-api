## Skill: 数据库操作（Database Operations）

### 目的

提供数据库操作的规范和指导，包括配置管理和数据库脚本的编写与执行。

---

### 环境配置

项目使用不同的配置文件来管理测试和生产环境：

- **测试环境配置**：`test.env`
- **生产环境配置**：`prod.env`

配置文件中包含数据库连接信息（DATABASE_URL）和其他环境变量。

#### 当前数据库配置

- **数据库类型**：MySQL
- **数据库服务器**：`rm-t4n395l1o71a3h36vzo.mysql.singapore.rds.aliyuncs.com`
- **端口**：`3306`
- **用户名**：`bitmodel`
- **测试数据库**：`newapi`
- **生产数据库**：`newapi-prod`

---

### 数据库脚本管理

#### 脚本存放位置

所有数据库脚本统一存放在：`db_scripts/`

#### 脚本命名规范

脚本文件名格式：`YYYY-MM-DD-功能描述.py`

示例：
- `2026-01-24-创建用户表.py`
- `2026-01-24-添加分发配置表.py`
- `2026-01-25-修改帖子表结构.py`

#### 脚本编写规范

每个脚本应该：
1. 使用 Python 编写
2. 包含清晰的注释说明脚本功能
3. 可以独立执行
4. 处理好数据库连接和错误处理

---

### 执行数据库脚本

#### 测试环境

```bash
# 加载测试环境配置
export $(cat test.env | xargs)

# 执行脚本
python db_scripts/2026-01-24-创建用户表.py
```

#### 生产环境

```bash
# 加载生产环境配置
export $(cat prod.env | xargs)

# 执行脚本
python db_scripts/2026-01-24-创建用户表.py
```

---

### 最佳实践

1. **先在测试环境验证**：所有脚本先在测试环境执行并验证
2. **做好备份**：生产环境执行前先备份数据
3. **记录执行日志**：记录脚本执行时间和结果
4. **版本控制**：所有脚本提交到 git 仓库
